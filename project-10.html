<!DOCTYPE HTML>

<html>
	<head>
		<title>PROJECT 10</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="index.html" class="logo">Project<strong> 10</strong></a>
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Plant Watering On-The-Go</h1>
									</header>

									<!-- Content -->
										<h2 id="content">HOW IT WORKS?</h2>
										<p>This project aims to switching on or off the pump using a relay and the web server. There is a need for manual installation of the wires of the pump to the relay, instructions are provided below.<br><br>

											You can also scale this project up by using the bigger black wires of the modules, which can handle up to 250 VAC. This includes light bulbs, electric fans, and more.


										</p>
										<h2 id="content">PARTS NEEDED:</h2>
										<p>• Main Board Module<br>
											• Smart Agriculture Module<br>
											• Connector Cables<br></p>

							<section>
								<header class="main">
									<h2 id="content">SENSOR IN THE MODULE TO BE USED</h2></header>
									<p><strong>Water Pump</strong><br> This device is used to transports water from one location to another through a hose and mechanical energy.</p>
							</section>
							</section>


						<!-- Image Section -->
						<h2>THE BUILD</h2>

						<!-- Main Image (pic11.jpg) -->
						<span class="image fit">
						    <a href="images/spump.jpg" class="image-link"><img src="images/spump.jpg" alt="" /></a>
						</span>


						<!-- Modal Dialog -->
						<div id="modal" class="modal">
						    <span class="close">&times;</span>
						    <img class="modal-content" id="modal-image">
						</div>

						<!-- JavaScript to Show Full Image on Click -->
						<script>
						    // Get all elements with class "image-link"
						    const imageLinks = document.querySelectorAll('.image-link');

						    // Get the modal element
						    const modal = document.getElementById('modal');

						    // Get the image element within the modal
						    const modalImg = document.getElementById('modal-image');

						    // Loop through each image link
						    imageLinks.forEach(link => {
						        link.addEventListener('click', function(event) {
						            event.preventDefault(); // Prevent default link behavior

						            // Get href attribute of the clicked link (full-size image URL)
						            const imageURL = this.getAttribute('href');

						            // Display the modal
						            modal.style.display = 'flex'; // Show the modal as flexbox for centering

						            // Set the clicked image as the source of the modal image
						            modalImg.src = imageURL;

						            // Reset modal content position
						            modal.scrollTop = 0;
						            modal.scrollLeft = 0;
						        });
						    });

						    // Close the modal when the close button (x) is clicked
						    const closeBtn = document.querySelector('.close');
						    closeBtn.addEventListener('click', function() {
						        modal.style.display = 'none';
						    });

						    // Close the modal when clicking outside of it
						    window.addEventListener('click', function(event) {
						        if (event.target === modal) {
						            modal.style.display = 'none';
						        }
						    });

						    // Enable zoom functionality
						    modalImg.addEventListener('click', function() {
						        if (modalImg.classList.contains('zoomed')) {
						            modalImg.classList.remove('zoomed');
						        } else {
						            modalImg.classList.add('zoomed');
						        }
						    });
						</script>


												<!-- Box -->
										<h2>INSTRUCTION(s):</h2>
													<div class="box">
														<p><strong>Step 1: Assembling the System</strong><br>
<strong>Positioning the Module:</strong><br>
1. Take the Smart Agriculture Module (enclosed in the 3D-printed box) and align it over the main board.<br>
2. Gently press the module onto the main board's connector pins until it fits securely in place.<br>   
3. Ensure that the module is correctly seated to avoid loose connections.<p>
<strong>Step 2: Powering the System</strong><br>
<strong>Connecting Power:</strong><br>
1. Get the connecting cable and attach it into the laptop that you will use to upload the code.<br>
2. Plug in the other end of it to the main board. The system will automatically power on.<br>
<strong>Visual Indicator Check:</strong><br>
Observe the LED indicators on the main board. The system should show a steady power LED to confirm it's operational.<p>
<strong>Step 3: Connecting to Web Server:</strong><br>
1. Once the serial monitor says "Code Uploaded", open the serial monitor of the Arduino IDE then press the <strong>EN</strong> button to show the IP address.<br>
2. Open your WiFi and look for <strong>ESP32_WaterPump</strong>. Choose that option and enter password <strong>12345678</strong><be>.
3. Enter the IP address in a search engine <strong>192.168.4.1</strong>. <p>
<strong>Step 4: Monitoring and Alerts</strong><br>
<strong>Understanding the Alerts:</strong><br>
1. The system is equipped with a visual (web server) alert.<br>
2. The web server will contain a button where they may be able to turn on or off the pump. In ideal situation, the water source of the pump is where the water level sensor is placed to make the system circulated.<br>
*For voltages exceeding 5 volts, use the black wires. Strip off one wire of the appliance or device that you will use. Connect one end to one of the wires and the other to the unoccuppied black wire.<p>
<strong>Testing the Alerts:</strong><br>
To test the system, tap the button to turn on the relay. You should hear a click.
														</p>
													</div>

<!-- Video Button -->
<button id="showVideoButton">Watch Video Instruction</button>

<!-- Video Modal -->
<div id="videoModal" class="modal">
    <span class="close" id="closeVideo">&times;</span>
    <div class="video-container">
        <video id="videoPlayer" controls>
            <source src="videos/agri.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
</div>

<!-- CSS for Styling -->
<style>
    /* Video Button */
    #showVideoButton {
        display: block;
        margin: 20px auto;
        padding: 1px 5px;
        background-color: transparent;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        font-size: 12px;
    }

    /* Video Modal */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        justify-content: center;
        align-items: center;
    }

    .video-container {
        width: 80%;
        max-width: 600px;
    }

    .close {
        position: absolute;
        top: 20px;
        right: 20px;
        font-size: 2rem;
        color: white;
        cursor: pointer;
    }

    video {
        width: 100%;
        height: auto;
        border: none;
    }
</style>

<!-- JavaScript for Modal Functionality -->
<script>
    // Get the elements
    const showVideoButton = document.getElementById("showVideoButton");
    const videoModal = document.getElementById("videoModal");
    const closeVideo = document.getElementById("closeVideo");
    const videoPlayer = document.getElementById("videoPlayer");

    // Show modal when button is clicked
    showVideoButton.addEventListener("click", function() {
        videoModal.style.display = "flex";
        videoPlayer.play(); // Auto-play video when modal is shown
    });

    // Close modal when the close button is clicked
    closeVideo.addEventListener("click", function() {
        videoModal.style.display = "none";
        videoPlayer.pause(); // Pause video when modal is closed
        videoPlayer.currentTime = 0; // Reset video to start
    });

    // Close modal when clicking outside the video
    window.addEventListener("click", function(event) {
        if (event.target === videoModal) {
            videoModal.style.display = "none";
            videoPlayer.pause(); // Pause video when modal is closed
            videoPlayer.currentTime = 0; // Reset video to start
        }
    });
</script>
							<!-- Preformatted Code -->

<html>
<head>
    <title>ESP32 Project</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body { font-family: Arial, sans-serif;}
        .code-section { background-color: #f5f5f5;}
        pre { white-space: pre-wrap; font-size: 0.9rem; color: #333;}
        h2 { margin: 0 0 5px 0; font-size: 1.2rem; }
    </style>
    							<div class="code-section">
							    <h2>CODE</h2>
							    <pre><code> <!DOCTYPE HTML>
</head>
<body>#include &lt;WiFi.h&gt;

// Define the GPIO pin connected to the soil moisture sensor
#define SENSOR_PIN 32

// WiFi credentials for AP mode
const char* ssid = "ESP32_Soil_Moisture";  // SSID of the AP
const char* password = "12345678";         // Password for the AP

WiFiServer server(80);

// HTML content for the web page
String HTMLPage = R"rawliteral(
  &lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Soil Moisture Level&lt;/title&gt;
    &lt;style&gt;
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        background: radial-gradient(circle, white, #00ab41);
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 10px;
        box-shadow: 0 20px 40px 20px rgba(0, 0, 0, 0.3);
      }
      h1 {
        font-size: 48px;
        margin-bottom: 20px;
      }
      p {
        font-size: 28px;
        margin-bottom: 30px;
      }
    &lt;/style&gt;
    &lt;script&gt;
      function updateData() {
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "/data", true);
        xhr.onreadystatechange = function() {
          if (xhr.readyState == 4 && xhr.status == 200) {
            var response = JSON.parse(xhr.responseText);
            document.getElementById("moistureValue").innerText = response.moistureValue;
            document.getElementById("soilStatus").innerText = response.soilStatus;
          }
        };
        xhr.send();
      }
      setInterval(updateData, 1000); // Update every second
    &lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class="container"&gt;
      &lt;h1&gt;Soil Moisture Level&lt;/h1&gt;
      &lt;p&gt;Moisture Value: &lt;span id="moistureValue"&gt;Loading...&lt;/span&gt;&lt;/p&gt;
      &lt;p&gt;Status: &lt;span id="soilStatus"&gt;Loading...&lt;/span&gt;&lt;/p&gt;
    &lt;/div&gt;
  &lt;/body&gt;
  &lt;/html&gt;
)rawliteral";

// Function to return sensor data as JSON
String getSensorData() {
  int sensorValue = analogRead(SENSOR_PIN);  // Read the sensor value
  String soilStatus;

  if (sensorValue &gt; 4000) {
    soilStatus = "Dry Soil";
  } else if (sensorValue &gt; 2500) {
    soilStatus = "Moist Soil";
  } else {
    soilStatus = "Wet Soil";
  }

  // Create a JSON string
  String jsonData = "{\"moistureValue\":" + String(sensorValue) + ", \"soilStatus\":\"" + soilStatus + "\"}";
  return jsonData;
}

void setup() {
  // Start the Serial Monitor
  Serial.begin(115200);

  // Initialize the sensor pin
  pinMode(SENSOR_PIN, INPUT);

  // Set up ESP32 as an Access Point
  Serial.println("Setting up Access Point...");
  WiFi.softAP(ssid, password);  // Start AP with SSID and password
  Serial.println("Access Point Created");
  
  // Display the IP address of the ESP32
  Serial.print("AP IP address: ");
  Serial.println(WiFi.softAPIP());

  // Start the server
  server.begin();
}

void loop() {
  WiFiClient client = server.available();

  if (client) {
    Serial.println("New Client connected");
    String request = "";
    unsigned long timeout = millis();
    while (client.connected() && millis() - timeout &lt; 2000) {
      if (client.available()) {
        char c = client.read();
        request += c;
        if (c == '\n') break;  // End of HTTP request
      }
    }

    // Handle root page request
    if (request.indexOf("GET / ") &gt;= 0) {
      client.println("HTTP/1.1 200 OK");
      client.println("Content-type:text/html");
      client.println();
      client.print(HTMLPage);
    } 
    // Handle sensor data request
    else if (request.indexOf("GET /data ") &gt;= 0) {
      client.println("HTTP/1.1 200 OK");
      client.println("Content-type:application/json");
      client.println();
      client.print(getSensorData());
    }
    // Handle other requests
    else {
      client.println("HTTP/1.1 404 Not Found");
      client.println("Content-type:text/plain");
      client.println();
      client.println("404: Not Found");
    }

    // Close the connection
    client.stop();
    Serial.println("Client disconnected");
  }
}
</body>
</html>
							</code></pre>
							    <button id="copyButton">Copy Code</button>
							</div>

<h2>CODE EXPLANATION</h2>
<div class="box">
    <p>This code sets up a Water Pump Control System using an ESP32 and a relay. The system allows users to toggle the water pump on and off and monitor its status through a web interface, which auto-updates in real-time using AJAX. Users can connect to an Access Point (AP) and control the pump through an intuitive, styled web page. Let’s break it down.

    <p><strong>Key Components and Their Roles</strong><br>
<strong>1. Libraries Included:</strong><br>
&emsp;&emsp;&emsp;•<strong><code>WiFi.h</code></strong>Executes Wi-Fi related activities, thus enabling the ESP32 to configure the formation of an Access Point for use by a user.<br>
&emsp;&emsp;&emsp;•<strong><code>WebServer.h</code></strong>Configures an HTTP server on the ESP32 to serve the web page for controling the pump and get the current state.<p>

<strong>2. WiFi Setup</strong><br>
&emsp;&emsp;&emsp;• By inserting the ESP32, an Access Point is configured with the Service Set Identifier (SSID) ESP32_WaterPump and the password 12345678 to enable users control the water pump.<br>
&emsp;&emsp;&emsp;• The ESP32 configures a static IP address for easy connection to the control interface by users.<p>

<strong>3. Relay Setup for Water Pump Control:</strong><br>
&emsp;&emsp;&emsp;• This relay is interfaced to Pin no. 5 of GPIO and it is intended for controlling the water pump. The <strong><code>relayPin</code></strong> is set to LOW by default thus the initially state of the pump is off.<br>
&emsp;&emsp;&emsp;•<strong><code>pumpStatus</code></strong>stores the state of the pump whether it is ON or OFF and changes with each click of the control button on the web page.<p>

<div class="button-container">
    <!-- Button to show first image -->
    <button id="showImageButton1" class="show-image-button">Relay Pinout</button>

    <!-- Button to show second image -->
    <button id="showImageButton2" class="show-image-button">ESP32 Pinout</button>
</div>

<!-- Hidden first image container -->
<div id="imageContainer1" class="hidden">
    <img src="images/relay.png" alt="Relay Image" style="max-width: 100%; height: auto;"><br>
    Photo Credit: Last Minute Engineers<p>
</div>

<!-- Hidden second image container -->
<div id="imageContainer2" class="hidden">
    <img src="images/esp32.jpg" alt="ESP32 Image" style="max-width: 100%; height: auto;"><br>
    Photo Credit: Random Nerd Tutorials<p>
</div>

<!-- JavaScript to handle button clicks for each image -->
<script>
    const showImageButton1 = document.getElementById("showImageButton1");
    const imageContainer1 = document.getElementById("imageContainer1");

    const showImageButton2 = document.getElementById("showImageButton2");
    const imageContainer2 = document.getElementById("imageContainer2");

    // Toggle first image visibility
    showImageButton1.addEventListener("click", function() {
        imageContainer1.classList.toggle("hidden");
    });

    // Toggle second image visibility
    showImageButton2.addEventListener("click", function() {
        imageContainer2.classList.toggle("hidden");
    });
</script>

<!-- CSS for styling -->
<style>
    /* Center the button container */
    .button-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        margin-top: 10px;
    }

    /* Style for buttons */
    .show-image-button {
        padding: 5px 10px;
        background-color: transparent;
        color: #7f888f;
        border: 2px solid #FF6F61;
        border-radius: 5px;
        cursor: pointer;
        font-size: 0.75rem;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 30px;
        transition: background-color 0.3s, color 0.3s;
    }

    /* Center text inside the button */
    .show-image-button:hover {
        background-color: rgba(255, 255, 255, 0.2);
        color: #00ab41;
    }

    /* Hide initially */
    .hidden {
        display: none;
    }

    /* Margin for image containers */
    #imageContainer1, #imageContainer2 {
        margin-top: 10px;
    }
</style><p>

<strong>4. Server Functions:</strong><br>
&emsp;&emsp;&emsp;• The ESP32 runs a web server<strong><code>(WebServer server(80);)</code></strong>, listening on port 80.<br>
&emsp;&emsp;&emsp;• Key server functions include:<br>
&emsp;&emsp;&emsp;&emsp;&emsp;•<strong><code>handleRoot()</code></strong>Takes the current pump status and display it to the main control page where users can start or stop the pump.<br>
&emsp;&emsp;&emsp;&emsp;&emsp;•<strong><code>handleToggle()</code></strong>Switches on or off the pump when the button on the web containing the web address is pressed. It is a switch type of pump whereby when one is on the other one is off.<br>
&emsp;&emsp;&emsp;&emsp;&emsp;•<strong><code>handleStatus()</code></strong>Sends the pump’s current state as a JSON response so that the page can auto-refresh every second.<p>

<strong>5. Web Interface Design:</strong><br> 
&emsp;&emsp;&emsp;• The HTML page is styled with CSS for neat alignment with the window in the middle, displaying the current status of the pump and another button to enable the pump.<br> 
&emsp;&emsp;&emsp;• The color and text used for the button are depending on the current state of the pump so that the user gets feedback about the current state of the pump.
<br> 
&emsp;&emsp;&emsp;• JavaScript refreshes the button and status text every one second to get new data through the<strong><code>/status</code></strong>endpoint.<p>

<strong>6. JavaScript and AJAX Updates:</strong><br> 
&emsp;&emsp;&emsp;• JavaScript on the web page periodically invokes the<strong><code>updateStatus()</code></strong> to retrieve the pump status and update the display without navigating the page.<br>
&emsp;&emsp;&emsp;• The<strong><code>togglePump()</code></strong>function updates the status of the pump.<p>

<strong>7. The Setup<code>setup()</code>and Loop<code>loop()</code>Functions:</strong><br> 
&emsp;&emsp;&emsp;•<strong><code>setup()</code></strong>Resets the relay pin, starts the Access Point and configure the web server to host the control interface.<br> 
&emsp;&emsp;&emsp;•<strong><code>loop()</code></strong>Ever engaged in conversational processing with the client to enablesequent communication and report on the condition of the water pump.<p>

</div>
											</div>
										</div>

								</section>

<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Homepage</a></li>
										<li><a href="generic.html">The Creation</a></li>
										<li><a href="elements.html">Module Explainer</a></li>
										<li>
											<span class="opener">Introductory Projects</span>
											<ul>
												<li><a href="io.html">Input Output</a></li>
												<li><a href="ai.html">Analog Inputs</a></li>
												<li><a href="pwm.html">PWM (Analog Output)</a></li>
												<li><a href="sws.html">Switch Web Server</a></li>
												<li><a href="rlws.html">RGB LED Web Server</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Main Projects</span>
											<ul>
												<li><a href="project-1.html">Project 1</a></li>
												<li><a href="project-2.html">Project 2</a></li>
												<li><a href="project-3.html">Project 3</a></li>
												<li><a href="project-4.html">Project 4</a></li>
												<li><a href="project-5.html">Project 5</a></li>
												<li><a href="project-6.html">Project 6</a></li>
												<li><a href="project-7.html">Project 7</a></li>
												<li><a href="project-8.html">Project 8</a></li>
												<li><a href="project-9.html">Project 9</a></li>
												<li><a href="project-10.html">Project 10</a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>ADVANCED IOT PROJECTS</h2>
									</header>
									<div class="mini-posts">
										<article>
											<a href="https://youtu.be/RUO44kqNP24?si=QO3qiHGQLvJSXDaD" class="image"><img src="https://i.ytimg.com/vi/RUO44kqNP24/hqdefault.jpg?sqp=-oaymwEXCNACELwBSFryq4qpAwkIARUAAIhCGAE=&rs=AOn4CLD_wUN6wdxf151rPD6UWSKlwhLK7Q" alt="" /></a>
											<p>Patient Health Monitoring System Using Raspberry Pi</p>
										</article>
										<article>
											<a href="https://youtu.be/FSqYyjZtH4g?si=9BeVl6KnJ2oD9eBl" class="image"><img src="https://i.ytimg.com/vi/FSqYyjZtH4g/hqdefault.jpg?sqp=-oaymwEbCKgBEF5IVfKriqkDDggBFQAAiEIYAXABwAEG&rs=AOn4CLCztyDAtqgoFMqVVEyold-aKebbbQ" alt="" /></a>
											<p>Women Safety Device Using Internet of Things</p>
										</article>
										<article>
											<a href="https://youtu.be/EamYfGG4Wvg?si=10C8m2DArmPMSOv3" class="image"><img src="https://i.ytimg.com/vi/EamYfGG4Wvg/hqdefault.jpg?sqp=-oaymwE1CKgBEF5IVfKriqkDKAgBFQAAiEIYAXABwAEG8AEB-AH0CYAC0AWKAgwIABABGGUgTShIMA8=&rs=AOn4CLBlZoYwXKvvyn9fsfvRhCCsItaQ3g" alt="" /></a>
											<p>A Web-Based Accident Reporting and Tracking System</p>
										</article>
									</div>
									<ul class="actions">
										<li><a href="https://youtube.com/playlist?list=PL87CgTAGz2yZ0geJ-_9HAK2u8NDMhVwFH&si=cr7ljhFT1B8GZR3-" class="button">More</a></li>
									</ul>
								</section>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="https://sscr.edu/Beta/">https://sscr.edu/Beta/</a></li>
										<li class="icon solid fa-phone">(046) 431-9405</li>
										<li class="icon solid fa-home">Manila-Cavite Road, Sta. Cruz,<br />
										Cavite City, 4100, Philippines</li>
									</ul>
								</section>

							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; SSC-RdC IOT Development Board. <br>All rights reserved.
								</footer>

						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="assets/js/copy.js"></script>

	</body>
</html>
